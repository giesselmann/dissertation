\chapter{State of the Art}
\label{cha:state_of_art}

Single-molecule real-time- and nanopore sequencing are commonly referred to as third generation sequencing technologies.
Continuous improvements on platform, library preparation and analysis software still lead to throughput and accuracy enhancements.
Following latest developments in third generation sequencing is therefore equally important for both, users and developers.
The availability of significantly longer reads enables novel insights, published in a rapidly growing number of studies, making a systematic and unbiased manual literature research increasingly complex.
The following review is therefore backed by the computational evaluation of meta data from publications in scientific journals.
Combining title, abstract and citations into a literature graph opens a unique perspective and provides a scalable approach to sweep any number of publications.
In addition to the major application fields of assembly, structural variant and isoform detection, we find a largely separated landscape, either relying on Pacific Biosciences or Oxford Nanopore Technologies.
Supplementary code for this chapter is available at \textit{https://github.com/giesselmann/scholar}.

\begin{figure}[h]
	\centering
	\includegraphics[width=1.0\textwidth]{figures/state_of_art/GA.pdf}
	\label{fig:state_of_art:ga}
\end{figure}

The chapter starts with a \textbf{background} in \ref{sec:state_of_art:background} followed by the setup and usage of a \textbf{literature database} containing scientific publication meta data in \ref{sec:state_of_art:database}. A big picture overview of \textbf{third generation sequencing} technologies in \ref{sec:state_of_art:third_generation}, is followed by a focus on \textbf{nanopore sequencing} in \ref{sec:state_of_art:nanopore}. Finally, most recent \textbf{throughput and accuracy} benchmarks on in-house data close the state of the art evaluation.




\section{Background}
\label{sec:state_of_art:background}

% stretch a bit more the general usage, not only for the novel nanopore field

The number of studies published per year in scientific journals is exponentially growing (Fig. \ref{fig:state_of_art:paper_count}).
Including only records with a digital object identifier (DOI) tracked by CrossRef and Semantic Scholar, results in a conservative estimation of 100k journals and a total of 5M paper being published only in 2020.
While the targeted discovery of specific studies remains feasible by indexing in search engines, the extensive and continuous tracking of an entire field of research becomes increasingly difficult.
Especially for the fast evolving field of nanopore sequencing, a zoomed out perspective is equally valuable for the orientation of newcomers and adaptation to latest developments in experienced groups.
A data driven literature scan facilitates the clustering of results and identification of key publications in an unbiased way.

%Zoom out history \cite{Deamer2016}
% axis labels capital, explain journal >= 5years, align legends to y-axis

\begin{figure}[h]
	\centering
	\includegraphics[width=1.0\textwidth]{figures/state_of_art/paper_count.pdf}
	\captionsetup{format=plain}
	\caption[Journals and publications per year]{Journals and new publications per year: \textbf{a}, Actively publishing scientific journals per year and journals with a publication history of at least five years. \textbf{b}, New publications per year and publications with at least 10 citations. (Semantic Scholar and CrossRef combined, only records with DOI)}
	\label{fig:state_of_art:paper_count}
\end{figure}

The following computer aided literature analysis is inspired by the Open Syllabus Galaxy\footnote{\url{https://galaxy.opensyllabus.org/}, accessed 01/2021} project.
Based on co-assignments of books in North American university courses, their literature graph of 160k books visualizes the linkage between research fields.
Applied to scientific journal publications, the success of the method is limited by the availability and quality of large scale meta data such as title, abstract and citations.
A number of platforms like Google Scholar, Web of Science, Dimensions or Microsoft Academic operate online literature databases, though without access to larger data chunks for systematic offline analysis.
Additional full text for advanced text mining is commonly only available through paid access from individual journals.




\section{Literature Database}
\label{sec:state_of_art:database}

For the purpose of tracing citations and clustering larger numbers of publications, we first setup a custom literature database.
The Semantic Scholar open research corpus (S2ORC) provides the largest available collection of scientific paper meta data and serves as starting point in this work \cite{Lo2020}.
Collected 07/2020, the data contains 77M papers linked by 333M citations.
Provided as compressed JSON files, the records are re-organized into a SQLite database with two main tables for records and citations.
Each record is uniquely identified by it's DOI and can additionally contain year, journal, title and abstract.
Citations are unique pairs of citing and cited DOI, referencing rows in the records table.
To further improve completeness of records and citations, we incrementally query the CrossRef REST API\footnote{\url{https://github.com/CrossRef/rest-api-doc}, accessed 01/2021} for novel entries, most recently in January 2021.
Citations are part of CrossRef but not provided through the API.
The CrossRef Open Citations Index (COCI) however, is regularly parsing and dumping citations and therefore integrated as well \cite{Peroni2020}.
Metrics of the final database used for this work are summarized in table \ref{tab:state_of_art:graph}. 
For comparison, the Dimensions\footnote{\url{https://www.dimensions.ai/}, accessed 01/2021} online platform lists 114M records and 1.3G citations.

\begin{table}[ht]
	\centering
	\caption[Literature Graph Metrics]{Literature database metrics}
	\label{tab:state_of_art:graph}
	\begin{tabular}{l|r}
		\hline
		citations (edges)           & 901 M 	\\
		paper (nodes)               & 116 M 	\\ \hline
		with title					& 115 M		\\
		with title \& abstract		&  57 M		\\ \hline
		connected nodes             &  68.4 M 	\\
		> 0 citations				&  56.6 M	\\
		> 5 citations				&  27.5 M	\\
		largest connected component &  67.9 M 	\\ \hline
	\end{tabular}
\end{table}

The network of publications and citations can also be interpreted as a literature graph with papers as nodes and citations as edges.
Only a fraction of 68M publications has either citing or cited edges.
The lack of citing (outgoing) edges indicates insufficient parsing of the papers reference sections, while the lack of cited (incoming) edges is likely a combination of technical limitations and unrecognized publications.
Striking though, is the presence of the largest connected component of 67.9M publications, where each paper can be reached via at least one citation edge.

A subset of publications originating from the S2ORC data set is annotated with a primary field of research from Microsoft Academic (MA). 
To get a first impression of the value of a literature graph, we extract all edges connecting papers with an annotated field of research.
A hierarchical clustering of summarized citation counts per field is plotted as heatmap in Fig. \ref{fig:state_of_art:field_interactions}, and shows an intuitive grouping of natural- and social sciences.

\begin{figure}[h]
	\centering
	\includegraphics[width=1.0\textwidth]{figures/state_of_art/field_interactions.pdf}
	\captionsetup{format=plain}
	\caption[Scientific field interactions]{Citation edges summarized by field of research: Sum of citations (log10) between and within fields of research (Hierarchical clustering, method: centroid, distance: cosine).}
	\label{fig:state_of_art:field_interactions}
\end{figure}

A graph is a powerful data structure, for instance to detect local communities or compute distances between nodes, however, with a growing number of nodes and edges it becomes impossible to visualize.
For the purpose of visualization and clustering, a graph embedding, similar to the \textit{node2vec} algorithm used in the OpenSyllabus project is therefore needed \cite{Grover2016}.
A graph embedding is a fixed length vector representation of each node, with the aim to preserve local connectivity.

The vector representation is enabling distance based clustering methods such as KMeans and dimensional reduction by principal component analysis (PCA) and uniform manifold approximation (UMAP).
Additionally, while sub-sampling nodes of a graph would split connected components, sub-sampling from an embedded graph, based on e.g. citation counts or topic, preserves the overall structure and reduces required compute resources.

Embedding the scientific literature graph using \textit{node2vec} is due to run-times of multiple weeks on CPU and large memory requirements on GPU not feasible.
We use therefore the \textit{DeepWalk} \cite{Perozzi2014} algorithm with its GPU implementation in \textit{GraphVite} \cite{Zhu2019}.
In order to fit on a GPU-server with 4x NVIDIA 2080Ti (11 GB RAM), only edges connecting publications with at least 20 citations are considered.
The resulting sub-graph, in the following referred to as \textbf{core\_20} graph, contains 9M nodes encompassed by virtually a single connected component.

Embedding with default parameters yields feature vectors of length 128 for each publication.
Following the OpenSyllabus projects workflow, the high-level visualization in Fig. \ref{fig:state_of_art:umap_global} is generated by first reducing to 64 dimensions using PCA (85\% explained variance), followed by further reduction to two dimensions using a UMAP.
For a better overview, only publications with fields considered relevant for this work are shown.

\begin{figure}[h]
	\centering
	\includegraphics[width=1.0\textwidth]{figures/state_of_art/umap_global.pdf}
	\captionsetup{format=plain}
	\caption[Scientific literature graph]{Scientific publication graph embedding: UMAP visualization of \textit{DeepWalk} graph embedding colored by field of research. Publications from 1980 onward with at least 20 citations (n=9M embedded, n\_neighbors 75, min\_dist 0.01, metric correlation, n=50k random sample of relevant fields plotted).}
	\label{fig:state_of_art:umap_global}
\end{figure}

In summary, the gathered SQLite literature database supports a variety of fast queries for e.g. research fields, journals, year of publication or citations.
The graph embedding of highly cited publications is a proof of concept to visualize literature based on citations and provides an intuitive perspective on field interactions.
Due to automated parsing, lack of visibility but also novelty of a paper, a considerable part of the database can not be embedded.
To address this issue, a future version with weighted pseudo-citations based on text similarities is planned.




\section{Third Generation Sequencing}
\label{sec:state_of_art:third_generation}

Both, the \textit{Nanopype} pipeline in chapter \ref{cha:nanopype} and \textit{STRique} repeat detection in chapter \ref{cha:strique} are exclusively developed for nanopore sequencing data.
Nevertheless, from a review perspective, both long read platforms are of interest, in particular when portability or initial acquisition cost play a secondary role.
The identification of third generation sequencing related publications is implemented in three steps of seed, extend and connect.
First, publications with keywords in either title or abstract are marked as seed paper.
The second step extends clusters around seed papers by following their citation edges in the literature graph.
Lastly, additional edges derived from text similarities and random walks in the \textbf{core\_20} backbone graph reduce the sparsity of the third generation citation graph.

Title and abstract columns of the records table are indexed for full text search using the SQLite \textit{FTS5} extension. 
For PacBio SMRT sequencing, the respective query is 'pacbio OR single molecule real time sequencing', for ONT 'nanopore sequencing' is used.
\textit{FTS5} is case-insensitive and works based on tokens, 'sequencing' for instance, is stemmed to 'sequenc', requiring a post processing step to validate matches and reduce false positives.
The number of seed papers for PacBio is 2900, for ONT 2852 paper contain the words 'nanopore' and 'sequencing' in title or abstract.
The output is comparable to the online platform Dimensions, which lists 3147 publications for 'nanopore sequencing' (queried 01/2021).

The extension of paper clusters around keywords is achieved by iteratively adding publications with a minimum number of citations and with a strong binding to the cluster.
The binding is computed as the fraction of in- or outgoing edges reaching nodes in the current cluster.
The seed extension is evaluated for different parameter combinations, with five citations and a minimum binding of 0.2 resulting in the largest stable cluster (Fig. \ref{fig:state_of_art:cluster_convergence}).
The PacBio and Nanopore cluster grow to similar sizes of 4392 and 4689 publications respectively and form the third generation sequencing cluster. 
The number of nodes reached by both extensions though, is with 308 unexpectedly low.

\begin{figure}[h]
	\centering
	\includegraphics[width=1.0\textwidth]{figures/state_of_art/cluster_convergence.pdf}
	\captionsetup{format=plain}
	\caption[Keyword Seed and Extend Convergence]{Cluster size convergence of keyword seed and extend strategy for PacBio query (\textbf{a}) and ONT query (\textbf{b}). The iteration is stopped on convergence, after 20 steps or on exceeding a threshold of 50k publications.}
	\label{fig:state_of_art:cluster_convergence}
\end{figure}

To further link isolated connected components and for additional preservation of the global graph structure, we complement the extracted third generation sub-graph by random walks in the \textbf{core\_20} backbone graph.
Each walk starts at a sub-graph node which is also contained in the \textbf{core\_20} graph and follows citation edges within the \textbf{core\_20} backbone, until another shared node is found, or a maximum length is reached.
Edges of random walks are only used for embedding, the additional nodes are ignored in the subsequent content analysis.
Of the initial 8.7k third generation sequencing sub-graph nodes, only 7.6k have citing or cited edges suitable for embedding.
In order to also integrate publications without citations, we add additional weighted edges based on text similarities between documents.
Specifically, a MinHash LSH Forest is used to perform top-k queries based on approximated Jaccard similarities \cite{Bawa2005}.
The LSH Forest is build of hashed titles and abstracts of all publications in the random walk expanded third generation graph.
For each publication, edges to the top 500 most similar documents in the set are stored as candidates, with the approximated Jaccard similarity as weight.
Of all candidate edges, the top 20\% edges between highly similar documents are added to the third generation graph.
For the embedding, the graph is treated as un-directed and weighted, with a constant weight of 1.0 assigned to all citation edges.
Applying the same \textit{DeepWalk} configuration and dimensionality reduction as above results in the third generation graph embedding shown in Fig. \ref{fig:state_of_art:umap_lr}.

\begin{figure}[h]
	\centering
	\includegraphics[width=1.0\textwidth]{figures/state_of_art/umap_lr.pdf}
	\captionsetup{format=plain}
	\caption[Third generation sequencing cluster]{Third generation sequencing cluster: The UMAP projection shows the \textit{DeepWalk} graph embedding with points scaled by number of citations. Colors indicate technology and seed/extend source.}
	\label{fig:state_of_art:umap_lr}
\end{figure}

The third generation literature graph embedding reveals a largely separated field of publications relying on either PacBio or Oxford Nanopore Technologies.
Aside from small outlier groups, a broad PacBio field is accompanied by three distinct accumulations of nanopore related work.

The embedding of only the third generation sequencing sub-graph is clustered after discarding nodes added by the random walk expansion.
Using the KMeans algorithm, an optimal number of clusters is found with 24 based on the distortion score.
A subsequent hierarchical clustering of cluster centers results in a distance based sorting (Fig. \ref{fig:state_of_art:cluster_sizes} a).
The ratio of seed to extension papers per technology and cluster confirms the previously noted separation of PacBio and ONT (Fig. \ref{fig:state_of_art:cluster_sizes} b).
Aside from small clusters of virtually only extension publications (ID 0, 6-7, 17-19), two major groups of which one (ID 20-23) contains only nanopore seeds and extensions become visible.
Remarkable is, that clusters with on average older publications tend to have a higher proportion of extensions.

\begin{figure}[h]
	\centering
	\includegraphics[width=1.0\textwidth]{figures/state_of_art/cluster_sizes.pdf}
	\captionsetup{format=plain}
	\caption[Long-Read Application Cluster]{Cluster of long-read applications: \textbf{a}, Hierarchical clustering of cluster centers assigns cluster IDs based on inter-cluster distance. \textbf{b}, Cluster size, seed to extend and technology composition are shown as stacked bar plots. \textbf{c}, Distributions of publication years per cluster with data as boxplots (centerline, median; box limits, first and third quartiles; whiskers, 1.5x interquartile range).}
	\label{fig:state_of_art:cluster_sizes}
\end{figure}

Word clouds provide an intuitive way for high-level content analysis of each cluster.
First, titles and abstracts are split into word tokens and further reduced to their stem using the Porter Stemming Algorithm.
Descriptive tokens are extracted using a term-frequency inverse-document-frequency (TF-IDF) embedding.
After filtering out tokens occurring in less than 10 documents or more than 20\% of the corpus, each token in each document is assigned a score based on how frequent it is mentioned in the document (for titles and abstracts commonly one) as opposed to how frequent it is found in the corpus.
The result is a word embedding matrix of 8k third generation sequencing publications times 4.6k descriptive word tokens.
After averaging TF-IDF scores per cluster, each clusters top 200 highest scoring tokens are illustrated as word clouds, of which three examples are shown in Fig. \ref{fig:state_of_art:wcs_minion}.

\begin{figure}[h]
	\centering
	\includegraphics[width=1.0\textwidth]{figures/state_of_art/wcs_minion.pdf}
	\captionsetup{format=plain}
	\caption[Nanopore Sequencing Word Clouds]{Nanopore sequencing word clouds of cluster 1, 15 and 16 reveal a virus identification, a composite cluster around the usage of the MinION and an algorithmic cluster around assembling, error correction and alignments.}
	\label{fig:state_of_art:wcs_minion}
\end{figure}

Not all word clouds can be translated into meaningful cluster labels.
Especially cluster with few publications or a high extension to seed ratio are difficult to characterize.
Nonetheless, for most cluster a high-level label is found and annotated into the graph embedding (Fig. \ref{fig:state_of_art:umap_cluster}).
Surprisingly, while referring to nanopore sequencing, the isolated clusters (ID 20-23) have no direct reference to Oxford Nanopore Technologies, but cover the development of novel protein and graphen based nanopores.
Beyond that, the token 'assembl' (words: assembly, assemble, assembling etc.) is one of the most prominent, and with different scaling found in almost all clusters.

\begin{figure}[h]
	\centering
	\includegraphics[width=1.0\textwidth]{figures/state_of_art/umap_cluster.pdf}
	\captionsetup{format=plain}
	\caption[Third generation sequencing applications]{Third generation sequencing applications: The UMAP projection shows the \textit{DeepWalk} graph embedding with points scaled by number of citations (1 for content linked publications). Colors indicate cluster with labels derived of most descriptive word tokens.}
	\label{fig:state_of_art:umap_cluster}
\end{figure}

The following section aims to provide a brief insight into major application fields for long-read sequencing technologies.
Key publications are determined as highly cited records per year and compared to the cluster community.
In clusters with only few seed publications, these are primarily mentioned to emphasize the role of the technology within the field.
An example for such a cluster is the transcriptomics field (ID 8,9).
The content of the composite 'MinION' cluster (ID 15) is further analyzed in section \ref{sec:state_of_art:nanopore}, concluding with the investigation of so far hidden use cases in epigenetics.




\section{Focus Nanopore Sequencing}
\label{sec:state_of_art:nanopore}

Review: Successful test launch for nanopore sequencing \cite{Loman2015a}



\subsection{Bioinformatics}
\label{subsec:state_of_art:bioinf}

Simulation (SMRT):
PBSIM: PacBio reads simulator—toward accurate genome assembly \cite{Ono2013}
SimLoRD: Simulation of Long Read Data \cite{Stoecker2016}

Visualization:
Poretools: a toolkit for analyzing nanopore sequence data \cite{Loman2014}
PoRe: An R package for the visualization and analysis of nanopore sequencing data \cite{Watson2014}
NanoOK: multi-reference alignment analysis of nanopore sequencing data, quality and error profiles \cite{Leggett2016}
NanoPack: visualizing and processing long-read sequencing data \cite{DeCoster2018}

Error correction:
Hybrid error correction and de novo assembly of single-molecule sequencing reads \cite{Koren2012}
proovread: large-scale high-accuracy PacBio correction through iterative short read consensus \cite{Hackl2014}
Oxford Nanopore sequencing, hybrid error correction, and de novo assembly of a eukaryotic genome \cite{Goodwin2015}

Basecalling:
Metrichor, albacore, guppy
DeepNano: Deep recurrent neural networks for base calling in MinION nanopore reads \cite{Boza2017}
Nanocall: an open source basecaller for Oxford Nanopore sequencing data \cite{David2017}
Chiron: translating nanopore raw signal directly into nucleotide sequence using deep learning \cite{Teng2018}
Performance of neural network basecalling tools for Oxford Nanopore sequencing \cite{Wick2019}
Nanopore Github:
\url{https://github.com/nanoporetech/bonito}
\url{https://github.com/nanoporetech/flappie}
\url{https://github.com/nanoporetech/scrappie}

Alignment:
Mapping single molecule sequencing reads using basic local alignment with successive refinement (BLASR): application and theory \cite{Chaisson2012}
Minimap and miniasm: fast mapping and de novo assembly for noisy long sequences \cite{Li2016}
Fast and sensitive mapping of nanopore sequencing reads with GraphMap \cite{Sovic2016}
NRMLR is missing: Accurate detection of complex structural variations using single-molecule sequencing \cite{Sedlazeck2018}




\subsection{Assembly}
\label{subsec:state_of_art:assembly}

Mind the Gap: Upgrading Genomes with Pacific Biosciences RS Long-Read Sequencing Technology \cite{English2012}
SSPACE-LongRead: scaffolding bacterial draft genomes using long read sequence information \cite{Boetzer2014}
Single-Molecule Real-Time Sequencing Combined with Optical Mapping Yields Completely Finished Fungal Genome \cite{Faino2015}

A hybrid approach for the automated finishing of bacterial genomes \cite{Bashir2012}
hybridSPAdes: an algorithm for hybrid assembly of short and long reads \cite{Antipov2016}
Phased diploid genome assembly with single-molecule real-time sequencing \cite{Chin2016}

A complete bacterial genome assembled de novo using only nanopore sequencing data \cite{Loman2015}

Chromosome-scale assemblies of plant genomes using nanopore long reads and optical maps \cite{Belser2018}
An improved assembly and annotation of the allohexaploid wheat genome identifies complete families of agronomic genes and provides genomic evidence for chromosomal translocations \cite{Clavijo2017}
Improved maize reference genome with single-molecule technologies \cite{Jiao2017}
Hybrid assembly of the large and highly repetitive genome of Aegilops tauschii, a progenitor of bread wheat, with the MaSuRCA mega-reads algorithm \cite{Zimin2017}
Draft genome sequence of Camellia sinensis var. sinensis provides insights into the evolution of the tea genome and tea quality \cite{Wei2018}
A high-quality apple genome assembly reveals the association of a retrotransposon and red fruit colour \cite{Zhang2019}


Tools:
Racon: Fast and accurate de novo genome assembly from long uncorrected reads \cite{Vaser2017}
Nanopore sequencing and the Shasta toolkit enable efficient de novo assembly of eleven human genomes \cite{Shafin2020}
Canu: scalable and accurate long-read assembly via adaptive k-mer weighting and repeat separation \cite{Koren2017}


Two important publications in 2020 are \textit{Flye} \cite{Kolmogorov2019} and \textit{Wtdbg2} \cite{Ruan2020}, both missed by the state of the art analysis so far.
Both abstracts do not contain a direct reference to either one of the long-read technologies and despite having already high citation counts, both are not reached by the extension strategy.
This example points to two shortcomings of the proposed literature mining strategy: First, it is only sensitive to topics (tokens) present in title and abstract.
Second, its success and coverage are decisively impacted by the seed-extension strategy.
Nonetheless, if specifically interested in assembling, the token 'assembl' would have picked both examples as seed publications.


\subsection{Structural Variant Detection}
\label{subsec:state_of_art:sv}

Mapping and phasing of structural variation in patient genomes using nanopore sequencing \cite{Stancu2017}
Structural variants identified by Oxford Nanopore PromethION sequencing of the human genome \cite{Coster2019}
SVIM: structural variant identification using mapped long reads \cite{Heller2019}
Missing NRMLR/Sniffles \cite{Sedlazeck2018}

Long read nanopore sequencing for detection of HLA and CYP2D6 variants and haplotypes \cite{Ammar2015}
Advances in DNA sequencing technologies for high resolution HLA typing \cite{Cereb2015}
PacBio-LITS: a large-insert targeted sequencing method for characterization of human disease-associated chromosomal structural variations \cite{Wang2015}

Dual redundant sequencing strategy: Full-length gene characterisation of 1056 novel and confirmatory HLA alleles \cite{Albrecht2017}
Profiling of Short-Tandem-Repeat Disease Alleles in 12,632 Human Whole Genomes \cite{Tang2017}




\subsection{Bacterial \& Viral Strain Analysis}
\label{subsec:state_of_art:strain}

proof concepts
Nanopore DNA Sequencing and Genome Assembly on the International Space Station \cite{Castro-Wallace2017}
Real-Time DNA Sequencing in the Antarctic Dry Valleys Using the Oxford Nanopore Sequencer \cite{Johnson2017}

ebola, zika, lassa fever
Real-time, portable genome sequencing for Ebola surveillance \cite{Quick2016}
Mobile real-time surveillance of Zika virus in Brazil \cite{Faria2016}
Metagenomic sequencing at the epicenter of the Nigeria 2018 Lassa fever outbreak \cite{Kafetzopoulou2019}
Direct RNA nanopore sequencing of full-length coronavirus genomes provides novel insights into structural variants and enables modification analysis \cite{Viehweger2019}

strain resistance
cite importance from one of the review-like papers
Diverse antibiotic resistance genes in dairy cow manure \cite{Wichmann2014}
MinION nanopore sequencing identifies the position and structure of a bacterial antibiotic resistance island \cite{Ashton2015}
Rapid antibiotic-resistance predictions from genome sequence data for Staphylococcus aureus and Mycobacterium tuberculosis \cite{Bradley2015}
Streaming algorithms for identification of pathogens and antibiotic resistance potential from real-time MinION(TM) sequencing \cite{Cao2016}

Rapid Nanopore Sequencing of Plasmids and Resistance Gene Detection in Clinical Isolates \cite{Lemon2017}
Same-Day Diagnostic and Surveillance Data for Tuberculosis via Whole-Genome Sequencing of Direct Respiratory Samples \cite{Votintseva2017}
Identification of bacterial pathogens and antimicrobial resistance directly from clinical urines by nanopore-based metagenomic sequencing \cite{Schmidt2017}
Nanopore metagenomics enables rapid clinical diagnosis of bacterial lower respiratory infection \cite{Charalampous2019}
Rapid inference of antibiotic resistance and susceptibility by genomic neighbour typing \cite{Brinda2020}

Rapid Pathogen Identification in Bacterial Pneumonia Using Real-Time Metagenomics \cite{Pendleton2017}
Rapid Nanopore Sequencing of Plasmids and Resistance Gene Detection in Clinical Isolates \cite{Lemon2017}




\subsection{Metagenomics \& Microbiomics}
\label{subsec:state_of_art:metagenomics}

Microbial phylogenetic profiling with the Pacific Biosciences sequencing platform \cite{Fichot2013}
Reducing assembly complexity of microbial genomes with single-molecule sequencing \cite{Koren2013}
Rapid metagenomic identification of viral pathogens in clinical samples by real-time nanopore sequencing analysis \cite{Greninger2015}
Complete, closed bacterial genomes from microbiomes using nanopore sequencing \cite{Moss2020}

16s
Improved performance of the PacBio SMRT technology for 16S rDNA sequencing \cite{Mosher2014}
Sequencing 16S rRNA gene fragments using the PacBio SMRT DNA sequencing system \cite{Schloss2016}
Evaluation of PacBio sequencing for full-length bacterial 16S rRNA gene classification \cite{Wagner2016}
Species-level resolution of 16S rRNA gene amplicons sequenced through the MinION portable nanopore sequencer \cite{Benitez-Paez2016}

Rapid draft sequencing and real-time nanopore sequencing in a hospital outbreak of Salmonella \cite{Quick2015}





\subsection{Isoform Detection}
\label{subsec:state_of_art:isoform}

PacBio 4M reads per smart cell
Nanopore 5-10M for cDNA kit, 1M direct RNA kit

Comprehensive comparison of Pacific Biosciences and Oxford Nanopore Technologies and their applications to transcriptome analysis \cite{Weirather2017}
A comprehensive examination of Nanopore native RNA sequencing for characterization of complex transcriptomes \cite{Soneson2019}

Characterization of Novel Transcripts in Pseudorabies Virus \cite{Tombacz2015}
Unveiling the complexity of the maize transcriptome by single-molecule long-read sequencing \cite{Wang2016}
A comprehensive approach to expression of L1 loci \cite{Deininger2017}
Characterization of the Dynamic Transcriptome of a Herpesvirus with Long-read Single Molecule Real-Time Sequencing \cite{Tombacz2017}
PacBio full-length cDNA sequencing integrated with RNA-seq reads drastically improves the discovery of splicing transcripts in rice \cite{Zhang2019a}
Full-length transcript characterization of SF3B1 mutation in chronic lymphocytic leukemia reveals downregulation of retained introns \cite{Tang2020}

Nanopore native RNA sequencing of a human poly(A) transcriptome \cite{Workman2019}

Potential but so far few publications
Accurate detection of m6A RNA modifications in native RNA sequences \cite{Liu2019}
Nanopore direct RNA sequencing maps the complexity of Arabidopsis mRNA processing and m6A modification \cite{Parker2020}

nanopore accuracy improvement




\subsection{Base Modification Detection}
\label{subsec:state_of_art:basemod}

Proof of readability paper \cite{Schreiber2013}
Compare to WGBS > methylation calling from mismatch in alignment

simpson \cite{Simpson2017}
rand \cite{Rand2017}
basecaller iterations, file format changes

ONT software: lack of methods/training data visibility
DeepMod: outdated on publication day, issues on reproducibility
DeepSignal: works with tombo on event tables written into raw data

PacBio methylation whitepaper \footnote{\url{https://www.pacb.com/wp-content/uploads/2015/09/WP_Detecting_DNA_Base_Modifications_Using_SMRT_Sequencing.pdf}, accessed 01/2021}:
25X for 6mA but 250X for 5mC and 5hmC

Benchmark
Systematic benchmarking of tools for CpG methylation detection from Nanopore sequencing \cite{Yuen2020}

Application with SV:
Same-day genomic and epigenomic diagnosis of brain tumors using real-time nanopore sequencing \cite{Euskirchen2017}

Novel:
Accurate targeted long-read DNA methylation and hydroxymethylation sequencing with TAPS \cite{Liu2020}
Simultaneous profiling of chromatin accessibility and methylation on human cell lines with nanopore sequencing \cite{Lee2020}




\section{Throughput and Accuracy}
\label{sec:stat_of_art:throughput}

\begin{itemize}
    \item Representative Flow-Cells over time (from 3 to 30 GBp in 48h)
    \item Size selection, shearing, nuclease flush
    \item accuracy guppy-fast, guppy-hac (mention albacore flappie, scrappie, SACall, chiron, ...)
    \item cite benchmark paper, illustrate need for in-house benchmark of each new version
    \item Mapping of long reads depending on genomic context, read length, Q-Score etc.
    \item Accuracy of base modifications: Nanopolish, Signalign, DeepMod, DeepSignal etc.
    %\item Nanopolish context and signal level analysis
\end{itemize}

\begin{figure}[h]
    \centering
    \includegraphics[width=1.0\textwidth]{figures/state_of_art/throughput.pdf}
    \captionsetup{format=plain}
    \caption[Throughput and accuracy]{Throughput and single read accuracy. \textbf{a}, Cumulative sequencing throughput over time of one representative MinION flow cell. Nuclease flushes unblock clogged pores and reload the flow cell with a new library. \textbf{b}, Density plot comparing single read accuracy (BLAST identiy) of 4k random reads basecalled with fast and high-accuracy model of \textit{Guppy} v3.5 and high-accuracy model of \textit{Guppy} v4.0 (Median accuracy: 0.90, 0.93, 0.95; Modal: 0.92, 0.94, 0.95).}
    \label{fig:state_of_art:throughput}
\end{figure}

\begin{figure}[h]
    \centering
    \includegraphics[width=1.0\textwidth]{figures/state_of_art/read_length.pdf}
    \captionsetup{format=plain}
    \caption[Read length median and N50]{Read length distribution: \textbf{a}, Read length distributions shown as number of reads per length (bins of 500nt) of two PromethION flow cells loaded with libraries from different DNA extraction methods. Dashed lines show median read length at 15883 (HUES8) and 14281 (J1). \textbf{b}, Read length distributions shown as sequenced basepairs per read length. Dashed lines show N50 at 21041 (HUES8) and 31906 (J1).}
    \label{fig:state_of_art:read_length}
\end{figure}

\begin{figure}[h]
    \centering
    \includegraphics[width=1.0\textwidth]{figures/state_of_art/methylation.pdf}
    \captionsetup{format=plain}
    \caption[Nanopore methylation detection]{Nanopore 5mC methylation detection: \textbf{a}, Correlation of whole genome bisulfite sequencing (WGBS) and nanopore sequenced mean methylation rates per genomic position (\textit{Nanopolish} detection with abs. log-p threshold: 2.5, min. coverage: 10X, reference hg19). \textbf{b}, Detection error depending on the applied absolute log-likelihood ratio (methylation probability) threshold. \textbf{c}, Fraction of dataset remaining depending on log-p value threshold.}
    \label{fig:state_of_art:methylation}
\end{figure}




\section{Summary}
\label{sec:stat_of_art:summary}









